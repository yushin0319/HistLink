# HistLink リレーション

日本史・西洋史の用語間のリレーションを定義。

---

## 統計

| カテゴリ | 件数 |
|---------|------|
| **総リレーション数** | **675件** |
| 日本史内リレーション | 389件 |
| 西洋史内リレーション | 269件 |
| 日本西洋史接点リレーション | 17件 |

---

## リレーションタイプ

| タイプ | 件数 | 説明 | 例 |
|--------|------|------|-----|
| **因果** | 220件 | A→Bの直接的原因 | 黒船 → 日米和親条約 |
| **契機** | 216件 | Aが引き金となってB | ペリー来航 → 開国 |
| **同時代** | 93件 | 同じ時代の関連事項 | 世界恐慌 ⇔ 世界恐慌（国際経済）|
| **対立** | 53件 | AとBが対立関係 | 平氏 ⇔ 源氏 |
| **文化** | 45件 | 時代・人物の文化的成果 | ルネサンス → レオナルド・ダ・ヴィンチ |
| **政策** | 43件 | 政策の結果 | 富国強兵 → 徴兵制 |
| **外交** | 5件 | 国際関係 | 日米和親条約 → 日米修好通商条約 |

---

## データ取得方法

### 全リレーション取得

```sql
SELECT
  r.id,
  t1.name AS src_name,
  t2.name AS dst_name,
  r.relation_type,
  r.keyword,
  r.explanation
FROM relations r
JOIN terms t1 ON r.src_id = t1.id
JOIN terms t2 ON r.dst_id = t2.id
ORDER BY r.src_id, r.dst_id;
```

### カテゴリ別取得

**日本史内リレーション（389件）:**
```sql
SELECT * FROM relations r
WHERE r.src_id BETWEEN 1 AND 100
  AND r.dst_id BETWEEN 1 AND 100;
```

**西洋史内リレーション（269件）:**
```sql
SELECT * FROM relations r
WHERE r.src_id BETWEEN 101 AND 200
  AND r.dst_id BETWEEN 101 AND 200;
```

**日本西洋史接点リレーション（17件）:**
```sql
SELECT * FROM relations r
WHERE (r.src_id BETWEEN 1 AND 100 AND r.dst_id BETWEEN 101 AND 200)
   OR (r.src_id BETWEEN 101 AND 200 AND r.dst_id BETWEEN 1 AND 100);
```

---

## 日本西洋史接点リレーション一覧

限定的な接点を設定（隘路設計）し、時代によって移動の難易度を調整。

| src_id | src_name | dst_id | dst_name | relation_type | keyword | explanation |
|--------|----------|--------|----------|---------------|---------|-------------|
| 178 | アヘン戦争 | 52 | ペリー来航 | 契機 | アジア進出の波 | アヘン戦争での欧米勝利がアジア進出を加速、ペリー来航へ |
| 166 | 産業革命 | 53 | 黒船 | 文化 | 蒸気機関の技術 | 産業革命の技術的成果である蒸気船が黒船として来航 |
| 157 | 啓蒙思想 | 52 | ペリー来航 | 文化 | 啓蒙思想の影響 | 啓蒙思想の自由・平等の理念が開国要求の背景に |
| 182 | 日露戦争（西洋視点） | 79 | 日露戦争 | 同時代 | 同一戦争 | 日露戦争は西洋史と日本史の重要な接点 |
| 183 | 第一次世界大戦（西洋史） | 82 | 第一次世界大戦 | 同時代 | 同一戦争 | 第一次世界大戦に日本も参戦 |
| 186 | ヴェルサイユ条約 | 82 | 第一次世界大戦 | 外交 | 戦後処理 | ヴェルサイユ条約で日本は戦勝国として参加 |
| 188 | 世界恐慌（国際経済） | 88 | 世界恐慌 | 同時代 | 同一恐慌 | 世界恐慌は日本経済にも深刻な影響 |
| 188 | 世界恐慌（国際経済） | 89 | 満州事変 | 契機 | 経済危機 | 世界恐慌が日本の軍部台頭と満州事変の背景に |
| 189 | ファシズムの台頭 | 89 | 満州事変 | 契機 | ファシズムの波 | 世界的なファシズムの台頭が満州事変を後押し |
| 189 | ファシズムの台頭 | 91 | 二・二六事件 | 契機 | 軍部台頭 | ファシズムの台頭が日本の二・二六事件に影響 |
| 192 | 第二次世界大戦（西洋史） | 92 | 日中戦争 | 同時代 | 同一戦争 | 第二次世界大戦の一部として日中戦争 |
| 192 | 第二次世界大戦（西洋史） | 93 | 太平洋戦争 | 同時代 | 同一戦争 | 第二次世界大戦の太平洋戦線 |
| 193 | 真珠湾攻撃（対米開戦） | 94 | 真珠湾攻撃 | 同時代 | 同一事件 | 真珠湾攻撃は日米開戦の契機 |
| 195 | 原爆投下 | 95 | ポツダム宣言 | 因果 | 降伏の決断 | 原爆投下がポツダム宣言受諾の決定的要因 |
| 195 | 原爆投下 | 96 | 終戦 | 因果 | 終戦の引き金 | 原爆投下が日本の終戦を決定づけた |
| 197 | 冷戦 | 97 | GHQ | 契機 | 冷戦構造 | 冷戦の開始がGHQの占領政策に影響 |
| 197 | 冷戦 | 99 | サンフランシスコ平和条約 | 外交 | 西側陣営 | 冷戦構造下で日本は西側陣営として講和 |

### 時代別分布

| 時代 | 接点数 |
|------|--------|
| 近世（江戸） | 3件 |
| 近代（幕末～明治） | 1件 |
| 現代（大正～） | 13件 |

**隘路設計**: 意図的に接点を限定し、特に近世～近代の移動を困難にすることでゲーム性を向上。

---

## リレーション構造の特徴

### 日本史リレーション（ID 1-100）

- 各用語は最低2つのリレーションを持つ
- 橋渡しノード（重要な歴史的転換点）には4-5個のリレーション
- 時代を超えたリレーションが多数存在（例：幕府制度の継承）

### 西洋史リレーション（ID 101-200）

- 古代ギリシャ・ローマから現代まで網羅
- 哲学・宗教・政治の連続性を重視
- ルネサンス→科学革命→啓蒙思想→市民革命の流れが明確

### 日本西洋史接点リレーション

限定的な接点を設定（隘路設計）：

| 時代 | 接点例 |
|------|--------|
| 近世 | アヘン戦争 → ペリー来航 |
| 近世 | 産業革命 → 黒船（蒸気船） |
| 近世 | 啓蒙思想 → ペリー来航 |
| 近代 | 日露戦争（西洋視点） ⇔ 日露戦争 |
| 現代 | 第一次世界大戦（西洋史） ⇔ 第一次世界大戦 |
| 現代 | 世界恐慌（国際経済） ⇔ 世界恐慌 |
| 現代 | 第二次世界大戦（西洋史） ⇔ 太平洋戦争 |
| 現代 | 原爆投下 → ポツダム宣言 / 終戦 |
| 現代 | 冷戦 → GHQ / サンフランシスコ平和条約 |

---

## ゲーム設計への影響

1. **日本史専用ルート**: ID 1-100のみを使用したゲームプレイが可能
2. **西洋史専用ルート**: ID 101-200のみを使用したゲームプレイが可能
3. **クロスオーバールート**: 接点リレーションを経由して日本史⇔西洋史の移動が可能
4. **隘路効果**: 接点が限定されているため、時代によっては移動が困難（ゲーム性の向上）

---

## グラフ品質

| 指標 | 値 |
|------|-----|
| 平均次数（degree） | 6.70 |
| 最小次数 | 2 ✅ |
| 最大次数 | 18 |
| Dead points | 0件 ✅ |
| 孤立ノード | 0件 ✅ |

すべての用語が最低2つのリレーションを持ち、行き止まりや孤立ノードが存在しない健全なグラフ構造。

---

## データソース

- **マイグレーションファイル**:
  - `database/migrations/002_seed_data.sql` - 日本史データ
  - `database/migrations/003_western_history_data.sql` - 西洋史データ
  - `database/migrations/004_fix_dead_points.sql` - Dead points修正
  - `database/migrations/005_complete_dead_points.sql` - 最終調整

- **データ品質チェック**:
  - `database/scripts/check_data_quality.sql`
  - `backend/tests/test_data_quality.py`
  - `data/data_quality_report.md`
